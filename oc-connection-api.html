<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../oc-core-utils/oc-core-utils.html">

<dom-module id="oc-connection-api">>
    <template>
        <iron-ajax id="getOrganisationConnections"></iron-ajax>
        <iron-ajax id="requestConnection"></iron-ajax>
        <iron-ajax id="getPendingOrganisationConnections"></iron-ajax>
    </template>

    <script>
        /**
         * `oc-connection-api`
         * Ordercloud API calls for connections endpoint
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class OcConnectionApi extends Ordercloud.ApiMixin(Polymer.Element) {
            static get is() { return 'oc-connection-api'; }
            static get properties() {};

            /**
             * Remove a connections from organisation
             *
             * @return {Promise}
             */
            
             getOrganisationConnections(organisationId) {
                this.$.getOrganisationConnections.url = this._generateUrl('organisations/' + organisationId + '/connections?pagesize=-1');
                this.$.getOrganisationConnections.method = 'GET';
                this.$.getOrganisationConnections.contentType = 'application/json';
                return this._generateRequest(this.$.getOrganisationConnections);
            }
            getPendingOrganisationConnections(organisationId) {
                this.$.getOrganisationConnections.url = this._generateUrl('organisations/' + organisationId + '/connections?status=PENDING&pagesize=-1');
                this.$.getOrganisationConnections.method = 'GET';
                this.$.getOrganisationConnections.contentType = 'application/json';
                return this._generateRequest(this.$.getOrganisationConnections);
            }
            requestConnection(organisationId, requestDetails) {
                this.$.requestConnection.url = this._generateUrl('organisations/' + organisationId + '/connections');
                this.$.requestConnection.method = 'POST';
                this.$.requestConnection.body = requestDetails;
                this.$.requestConnection.contentType = 'application/json';
                return this._generateRequest(this.$.requestConnection);
            }
        }



        window.customElements.define(OcConnectionApi.is, OcConnectionApi);
    </script>
</dom-module>

